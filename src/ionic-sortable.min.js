!function(a,b){"use strict";function d(a){if(!("clientX"in a||"clientY"in a)){var b=a.touches||a.originalEvent.touches;b&&b.length&&(a.clientX=b[0].clientX,a.clientY=b[0].clientY),a.preventDefault()}}function e(a){if(a=a[0],a.previousElementSibling)return b.element(a.previousElementSibling);for(var c=a.previousSibling;null!=c&&1!=c.nodeType;)c=c.previousSibling;return b.element(c)}function f(a,b){var c=e(a);c.length>0?"sv-placeholder"==c[0].className?a.parent().after(b):c.after(b):a.parent().prepend(b)}function i(a,c){if(a instanceof b.element&&(a=a[0]),null!==h)return a[h](c)}var c=b.module("ionic-sortable",[]);c.directive("svRoot",[function(){function a(a,b,c,d){if(c){var e=d.left<b.x&&b.x<d.right&&d.top<b.y&&b.y<d.bottom;return!e}return a.y-b.y<0}function c(a){return g[a]}function d(a){delete g[a]}var e,g=Object.create(null);return{restrict:"A",controller:["$scope","$attrs","$interpolate","$parse",function(h,j,k,l){var m=k(j.svRoot)(h)||h.$id;g[m]||(g[m]=[]);var o,p,q,r,s,t,u=!1,v=l(j.svOnSort);j.svOnStart=j.$$element[0].attributes["sv-on-start"],j.svOnStart=j.svOnStart&&j.svOnStart.value,j.svOnStop=j.$$element[0].attributes["sv-on-stop"],j.svOnStop=j.svOnStop&&j.svOnStop.value;var w=l(j.svOnStart),x=l(j.svOnStop);if(this.sortingInProgress=function(){return e},j.svGrid){if(u="true"===j.svGrid||"false"!==j.svGrid&&null,null===u)throw"Invalid value of sv-grid attribute"}else h.$watchCollection(function(){return c(m)},function(a){u=!1;var b=a.filter(function(a){return!a.container}).map(function(a){return{part:a.getPart().id,y:a.element[0].getBoundingClientRect().top}}),c=Object.create(null);b.forEach(function(a){c[a.part]?c[a.part].push(a.y):c[a.part]=[a.y]}),Object.keys(c).forEach(function(a){c[a].sort(),c[a].forEach(function(b,d){d<c[a].length-1&&b>0&&b===c[a][d+1]&&(u=!0)})})});this.$moveUpdate=function(d,g,j,k,l,n,v){var x=j[0].getBoundingClientRect();"element"===d.tolerance&&(g={x:~~(x.left+x.width/2),y:~~(x.top+x.height/2)}),e=!0,o=[],p||(l?(p=l.clone(),p.removeClass("ng-hide")):(p=k.clone(),p.addClass("sv-visibility-hidden"),p.addClass("sv-placeholder"),p.css({height:x.height+"px",width:x.width+"px"})),k.after(p),k.addClass("ng-hide"),s=k,q=d,r=j,w(h,{$helper:{element:r},$part:n.model(n.scope),$index:v,$item:n.model(n.scope)[v]}),h.$root&&h.$root.$$phase||h.$apply());var y=b.element(document.querySelector(".organizePagesContent"))[0];y.getBoundingClientRect();r[0].reposition({x:g.x+y.scrollLeft-g.offset.x*x.width,y:g.y+y.scrollTop-g.offset.y*x.height}),c(m).forEach(function(b,c){if(null==d.containment||i(b.element,d.containment)||i(b.element,d.containment+" *")){var e=b.element[0].getBoundingClientRect(),f={x:~~(e.left+e.width/2),y:~~(e.top+e.height/2)};b.container||!b.element[0].scrollHeight&&!b.element[0].scrollWidth||o.push({element:b.element,q:Math.sqrt(Math.pow(f.x-g.x,2)+Math.pow(f.y-g.y,2)),view:b.getPart(),targetIndex:b.getIndex(),after:a(f,g,u,e)}),b.container&&!b.element[0].querySelector("[sv-element]:not(.sv-placeholder):not(.sv-source)")&&o.push({element:b.element,q:Math.sqrt(Math.pow(f.x-g.x,2)+Math.pow(f.y-g.y,2)),view:b.getPart(),targetIndex:0,container:!0})}});var A=p[0].getBoundingClientRect(),B={x:~~(A.left+A.width/2),y:~~(A.top+A.height/2)};o.push({q:Math.sqrt(Math.pow(B.x-g.x,2)+Math.pow(B.y-g.y,2)),element:p,placeholder:!0}),o.sort(function(a,b){return a.q-b.q}),o.forEach(function(a,b){0!==b||a.placeholder||a.container?0===b&&a.container?(t=a,a.element.append(p)):a.element.removeClass("sv-candidate"):(t=a,a.element.addClass("sv-candidate"),a.after?a.element.after(p):f(a.element,p))})},this.$drop=function(a,c,d){function m(){if(e=!1,p.remove(),r.remove(),s.removeClass("ng-hide"),o=void 0,p=void 0,d=void 0,r=void 0,s=void 0,x(h,{$part:a.model(a.scope),$index:c,$item:a.model(a.scope)[c]}),t){t.element.removeClass("sv-candidate");var b=a.model(a.scope).splice(c,1),f=t.targetIndex;t.view===a&&t.targetIndex>c&&f--,t.after&&f++,t.view.model(t.view.scope).splice(f,0,b[0]),t.view===a&&c===f||v(h,{$partTo:t.view.model(t.view.scope),$partFrom:a.model(a.scope),$item:b[0],$indexTo:f,$indexFrom:c})}t=void 0,h.$root&&h.$root.$$phase||h.$apply()}if(p)if(d.revert){var f=p[0].getBoundingClientRect(),g=r[0].getBoundingClientRect(),i=Math.sqrt(Math.pow(g.top-f.top,2)+Math.pow(g.left-f.left,2)),j=+d.revert*i/200;j=Math.min(j,+d.revert),["-webkit-","-moz-","-ms-","-o-",""].forEach(function(a){"undefined"!=typeof r[0].style[a+"transition"]&&(r[0].style[a+"transition"]="all "+j+"ms ease")}),setTimeout(m,j);var k=b.element(document.querySelector(".organizePagesContent"))[0],l=k.getBoundingClientRect();r.css({top:f.top+k.scrollTop-l.top+"px",left:f.left+k.scrollLeft+"px"})}else m()},this.addToSortableElements=function(a){c(m).push(a)},this.removeFromSortableElements=function(a){var b=c(m),e=b.indexOf(a);e>-1&&(b.splice(e,1),0===b.length&&d(m))}}]}}]),c.directive("svPart",["$parse",function(a){return{restrict:"A",require:"^svRoot",controller:["$scope",function(a){a.$ctrl=this,this.getPart=function(){return a.part},this.$drop=function(b,c){a.$sortableRoot.$drop(a.part,b,c)}}],scope:!0,link:function(b,c,d,e){if(!d.svPart)throw new Error("no model provided");var f=a(d.svPart);if(!f.assign)throw new Error("model not assignable");b.part={id:b.$id,element:c,model:f,scope:b},b.$sortableRoot=e;var g={element:c,getPart:b.$ctrl.getPart,container:!0};e.addToSortableElements(g),b.$on("$destroy",function(){e.removeFromSortableElements(g)})}}}]),c.directive("svElement",["$parse",function(a){return{restrict:"A",require:["^svPart","^svRoot"],controller:["$scope",function(a){a.$ctrl=this}],link:function(c,e,f,g){function w(a){l=a.clientY;var d=j.call(e,".scroll"),f=d[0].getBoundingClientRect(),g=d.parent(),h=g[0].getBoundingClientRect();p=h.height,n=h.top;var i=b.element(document.querySelector(".pages-container"));i[0].getBoundingClientRect();m=i.height,o=m-f.height,c.scrollFlag=!0}function x(){var a=0;if(l>=0&&l<n+q?a=l-(n+q):l>=0&&l>p-q&&(a=l-(p-q)),0!==a){var b=h.scrollTop+r*a;b<0?b=0:b>o&&(b=o),h.scrollTop=b}}function y(h){function t(a){d(a),w(a),setInterval(function(){c.scrollFlag&&x()},500),k||(e.parent().prepend(p),k=!0),g[1].$moveUpdate(l,{x:a.clientX,y:a.clientY,offset:s},p,e,v,g[0].getPart(),c.$index)}if(d(h),!g[1].sortingInProgress()&&(0==h.button||"mousedown"!==h.type)){k=!1;var l=a(f.svElement)(c);if(l=b.extend({},{tolerance:"pointer",revert:200,containment:"html"},l),l.containment)var m=j.call(e,l.containment)[0].getBoundingClientRect();var p,n=e,o=e[0].getBoundingClientRect();u||(u=g[0].helper),v||(v=g[0].placeholder);var q=b.element(document.querySelector(".organizePagesContent"))[0],r=q.getBoundingClientRect();u?(p=u.clone(),p.removeClass("ng-hide"),p.css({left:o.left+q.scrollLeft+"px",top:o.top+q.scrollTop+"px"}),n.addClass("sv-visibility-hidden")):(p=n.clone(),p.addClass("sv-helper").css({left:o.left+q.scrollLeft+"px",top:o.top+q.scrollTop+"px",width:o.width+"px"})),p[0].reposition=function(a){var c=a.x,d=a.y,e=p[0].getBoundingClientRect(),f=b.element(document.querySelector(".organizePagesContent"))[0];m&&(d<m.top||(d<m.top+f.scrollTop?d=m.top+f.scrollTop:d+e.height>m.top+f.scrollTop+m.height&&(d=m.top+f.scrollTop+m.height-e.height)),c<m.left+f.scrollLeft&&(c=m.left+f.scrollLeft),c+e.width>m.left+f.scrollLeft+m.width&&(c=m.left+f.scrollLeft+m.width-e.width)),this.style.left=c-f.scrollLeft+"px",this.style.top=d+"px"};var s={x:(h.clientX-o.left)/o.width,y:(h.clientY-o.top+r.top)/o.height};i.addClass("sv-sorting-in-progress"),i.on("mousemove touchmove",t).on("mouseup touchend touchcancel",function a(b){i.off("mousemove touchmove",t),i.off("mouseup touchend touchcancel",a),i.removeClass("sv-sorting-in-progress"),c.scrollFlag=!1,k&&g[0].$drop(c.$index,l),e.removeClass("sv-visibility-hidden")})}}var h=b.element(document.querySelector(".organizePagesContent"))[0],i=b.element(document.documentElement);c.scrollFlag=!1;var k,l,m,n,o,p,q=20,r=.05,s={element:e,getPart:g[0].getPart,getIndex:function(){return c.$index}};g[1].addToSortableElements(s),c.$on("$destroy",function(){g[1].removeFromSortableElements(s)});var t=e;t.on("mousedown touchstart",function(a){c.longPress=!0;var b=h.scrollTop;setTimeout(function(){if(c.longPress){var d=h.scrollTop,e=Math.abs(b-d),f=t[0].getBoundingClientRect();e<f.height/2&&y(a)}},300)}),c.$watch("$ctrl.handle",function(a){a&&(t.off("mousedown touchstart",y),t=a,t.on("mousedown touchstart",y))}),t.on("touchend",function(a){c.longPress=!1});var u;c.$watch("$ctrl.helper",function(a){a&&(u=a)});var v;c.$watch("$ctrl.placeholder",function(a){a&&(v=a)})}}}]),c.directive("svHandle",function(){return{require:"?^svElement",link:function(a,b,c,d){d&&(d.handle=b.add(d.handle))}}}),c.directive("svHelper",function(){return{require:["?^svPart","?^svElement"],link:function(a,b,c,d){b.addClass("sv-helper").addClass("ng-hide"),d[1]?d[1].helper=b:d[0]&&(d[0].helper=b)}}}),c.directive("svPlaceholder",function(){return{require:["?^svPart","?^svElement"],link:function(a,b,c,d){b.addClass("sv-placeholder").addClass("ng-hide"),d[1]?d[1].placeholder=b:d[0]&&(d[0].placeholder=b)}}}),b.element(document.head).append(["<style>.sv-helper{position: fixed !important;z-index: 99999;margin: 0 !important;}.sv-candidate{}.sv-placeholder{}.sv-sorting-in-progress{-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.sv-visibility-hidden{visibility: hidden !important;opacity: 0 !important;}</style>"].join(""));var g=document.documentElement,h=g.matches?"matches":g.matchesSelector?"matchesSelector":g.webkitMatches?"webkitMatches":g.webkitMatchesSelector?"webkitMatchesSelector":g.msMatches?"msMatches":g.msMatchesSelector?"msMatchesSelector":g.mozMatches?"mozMatches":g.mozMatchesSelector?"mozMatchesSelector":null;if(null==h)throw"This browser doesn't support the HTMLElement.matches method";var j=b.element.prototype.closest||function(a){for(var c=this[0].parentNode;c!==document.documentElement&&!c[h](a);)c=c.parentNode;return c[h](a)?b.element(c):b.element()};"function"!=typeof b.element.prototype.add&&(b.element.prototype.add=function(a){var c,d=b.element();for(a=b.element(a),c=0;c<this.length;c++)d.push(this[c]);for(c=0;c<a.length;c++)d.push(a[c]);return d})}(window,window.angular);